---
title: Chapter 2 - Code
output: html_notebook
---

```{r setup}
library(RPostgreSQL)
db <- dbConnect(dbDriver("PostgreSQL"), dbname = "blog", host = "localhost")
knitr::opts_chunk$set(connection = "db")
```

---

```{sql}
SELECT *
FROM users
WHERE username = 'sporty88';
```

```{sql}
SELECT *
FROM users
WHERE username <> 'sporty88';
```

```{sql}
SELECT *
FROM users
WHERE id = 9;
```

```{sql}
SELECT *
FROM users
WHERE age > 21;
```

```{sql}
SELECT *
FROM users
WHERE age >= 21;
```

---

Select all records from `reads` where a user read the first blog post (`id` = 1) *before* January 20?

```{sql}
SELECT *
FROM reads
WHERE date_read <= '2017-01-19'
AND post_id = 1;
```

Return all posts launched between 2017-01-15 and 2017-01-21. (You'll see an easier way to do this shortly!)

```{sql}
SELECT *
FROM posts
WHERE date_posted >= '2017-01-15'
AND date_posted <= '2017-01-21';
```

Return all posts launched before 2017-01-05 or after 2017-01-21.

```{sql}
SELECT *
FROM posts
WHERE date_posted < '2017-01-15'
OR date_posted > '2017-01-21';
```

Now incorporate an aggregate function to COUNT the number of posts satisfying these conditions.

```{sql}
SELECT COUNT(*)
FROM posts
WHERE date_posted < '2017-01-15'
OR date_posted > '2017-01-21';
```

---

```{sql}
SELECT *
FROM users
WHERE age BETWEEN 30 AND 40;
```

Which of the following is equivilent to the query above?

```{sql}
SELECT *
FROM users
WHERE age >= 30
AND age <= 40;
```

---

Select all records from reads where duration is between 200 and 500.

```{sql}
SELECT *
FROM reads
WHERE duration BETWEEN 200 AND 500;
```

Select all records from reads where duration is between 200 and 500 or greater than 800.

```{sql}
SELECT *
FROM reads
WHERE duration BETWEEN 200 AND 500
OR duration > 800;
```

Use IN to select all records from reads where post_id is 3, 6, or 8.

```{sql}
SELECT * FROM reads
WHERE post_id IN (3, 6, 8);
```

Use a combination of BETWEEN and IN to select all records from reads where post_id is 3, 6, or 8 and duration is between 400 and 600.

```{sql}
SELECT * FROM reads
WHERE post_id IN (3, 6, 8)
AND duration BETWEEN 400 AND 600;
```

---

Manage missingness...















